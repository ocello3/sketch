## 概要
上から水滴が落ちる。
画面を縦に4分割した層があり、３つの境目を通過したときにそれぞれのアニメーションをトリガーする。

## 落ちる水滴
- [x] 速度は「うっすら加速する」程度
- [x] 軌跡を破線で残す。
- [x] 破線の始点は上1/3でランダムとする。
- [x] 破線の長さは画面サイズ1/3でランダムとする。
- [x] 地面に落ちた時、初期化(位置、始点、長さを再計算)する。
- [x] 開始時、あるいは初期化時に位置を負(画面外)とすることで、落下開始のタイミングをずらす。
- [x] 破線の太さの初期値は初速が早ければ太く、遅ければ細くする。endPosに近づくに連れて細くなる。→　pixel単位でしか指定できないので色の濃さを使うことにする。
- [x] 各層の衝突判定の変数をdrop.jsで管理する。

## 図形の疑似的な3D描写について
手前（画面サイズ分）の斜め上（y = 0の位置）から見ているように画面を変形させる。
円の変形は楕円の縦横比を調整して表現する。

## １層目
境目に板があり、水滴が分裂し、はじかれる。
音：01 type
arc(x, y, w, h, start, stop)を用いる。
arcのstartは0が円の右の位置なので、直観的ではない。そのため、左方向の波紋と右方向の波紋それぞれで補正する。
右方向の波紋：０時の位置をstartとして、時計回りに進むようにする。
左方向の波紋：０時の位置をstartとして、反時計回りに進ようにする。
x：dropのposに同じ
y：固定位置（画面の3/4位置）
w：徐々に広がる
h：徐々に広がる
start, stop：角度から産出する。
angle：徐々に幅が広がる。
千の太さは水滴と同じにする。
色の濃さ徐：徐々に薄くする。angleWidthがPIになるときを波紋の拡張の終了とみなして、0からPIの進捗率から濃さを算出する。
- [x] 条件分岐のyPosが分かりづらいので、先頭で変数yPosを宣言して条件分岐で用いる。

## ２層目
丸いポールを覆うように水滴が垂れて、雫になる。
音：02 tap 05

## ３層目
水が張っていて、波紋が広がる。
音：01 button

## 衝突判定
preYPosとnewYPosを比較する。境界の位置をtargetYとすると、
1. newYPos < targetY: 衝突前
2. newYPos > targetY && preYPos < targetY：衝突
3. newYPos > targetY && preYPos > targetY：衝突後

## 各層の初期化と最初期化のタイミング
1ループ目は、初期化時に各層のオブジェクトを初期化する。
衝突判定がonとなったタイミングで各層のオブジェクトのupdateを開始する。
次の衝突判定がonになるタイミングまでupdateを続ける。
次の衝突判定がonになるタイミングで再初期化する。
再初期化の次のフレームからupdateを開始する。


## 反省
空間的な表現を2Dモードで描画するのは無理そう。